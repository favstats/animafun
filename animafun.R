library(tidyverse)

# take a vector of inputs and return a binary 
# matrix corresponding to the character
read_letter <- function(...) {
  cbind(
    matrix(data = c(...), nrow = 9, ncol = 5, byrow = TRUE),
    matrix(data = rep(0,9), nrow = 9, ncol = 1)
  )
}

# for visual clarity only
. <- 0 

# character data based on the BPdots font
# https://www.1001fonts.com/bpdots-font.html
char_list <- list(
  " " = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "A" = read_letter(
    .,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,.)
  ,
  "B" = read_letter(
    1,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "C" = read_letter(
    .,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,.,1,
    .,1,1,1,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "D" = read_letter(
    1,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "E" = read_letter(
    1,1,1,1,1,
    1,.,.,.,.,
    1,.,.,.,.,
    1,1,1,1,.,
    1,.,.,.,.,
    1,.,.,.,.,
    1,1,1,1,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "F" = read_letter(
    1,1,1,1,1,
    1,.,.,.,.,
    1,.,.,.,.,
    1,1,1,1,.,
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "G" = read_letter(
    .,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,1,1,
    1,.,.,.,1,
    .,1,1,1,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "H" = read_letter(
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "I" = read_letter(
    1,1,1,1,1,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    1,1,1,1,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "J" = read_letter(
    1,1,1,1,.,
    .,.,.,1,.,
    .,.,.,1,.,
    .,.,.,1,.,
    .,.,.,1,.,
    1,.,.,1,.,
    .,1,1,.,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "K" = read_letter(
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,1,.,
    1,1,1,.,.,
    1,.,.,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "L" = read_letter(
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,.,.,
    1,1,1,1,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "M" = read_letter(
    1,.,.,.,1,
    1,1,.,1,1,
    1,1,.,1,1,
    1,.,1,.,1,
    1,.,1,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "N" = read_letter(
    1,.,.,.,1,
    1,1,.,.,1,
    1,.,1,.,1,
    1,.,1,.,1,
    1,.,.,1,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "O" = read_letter(
    .,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,1,1,1,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "P" = read_letter(
    1,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,.,
    1,.,.,.,.,
    1,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.),  
  "Q" = read_letter(
    .,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,1,.,1,
    .,1,1,1,.,
    .,.,1,.,.,
    .,.,.,1,.),
  "R" = read_letter(
    1,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,.,
    1,.,.,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "S" = read_letter(
    .,1,1,1,1,
    1,.,.,.,.,
    1,.,.,.,.,
    .,1,1,1,.,
    .,.,.,.,1,
    .,.,.,.,1,
    1,1,1,1,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "T" = read_letter(
    1,1,1,1,1,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "U" = read_letter(
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,1,1,1,.,
    .,.,.,.,.,
    .,.,.,.,.),  
  "V" = read_letter(
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,1,.,1,.,
    .,1,.,1,.,
    .,.,1,.,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "W" = read_letter(
    1,.,.,.,1,
    1,.,1,.,1,
    1,.,1,.,1,
    1,.,1,.,1,
    1,.,1,.,1,
    .,1,.,1,.,
    .,1,.,1,.,
    .,.,.,.,.,
    .,.,.,.,.),  
  "X" = read_letter(
    1,.,.,.,1,
    1,.,.,.,1,
    .,1,.,1,.,
    .,.,1,.,.,
    .,1,.,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "Y" = read_letter(
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,1,.,1,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "Z" = read_letter(
    1,1,1,1,1,
    .,.,.,.,1,
    .,.,.,1,.,
    .,.,1,.,.,
    .,1,.,.,.,
    1,.,.,.,.,
    1,1,1,1,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "a" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,.,
    .,.,.,.,1,
    .,1,1,1,1,
    1,.,.,.,1,
    .,1,1,1,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "b" = read_letter(
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,1,1,.,
    1,1,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,.,
    .,.,.,.,.,
    .,.,.,.,.),
  "c" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,., ##
    1,.,.,.,1,
    1,.,.,.,.,
    1,.,.,.,1,
    .,1,1,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "d" = read_letter(
    .,.,.,.,1,
    .,.,.,.,1,
    .,1,1,1,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,1,1,
    .,1,1,.,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "e" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,.,
    1,.,.,.,1,
    1,1,1,1,1,
    1,.,.,.,.,
    .,1,1,1,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "f" = read_letter(
    .,.,.,1,1,
    .,.,1,.,.,
    .,1,1,1,1,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    1,1,1,1,1,
    .,.,.,.,.,
    .,.,.,.,.), 
  "g" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,1,1,
    .,1,1,.,1,
    .,.,.,.,1,
    .,1,1,1,.),  
  "h" = read_letter(
    1,.,.,.,.,
    1,.,.,.,.,
    1,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,.),
  "i" = read_letter(
    .,.,1,.,.,
    .,.,.,.,.,
    1,1,1,.,., ##
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    1,1,1,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "j" = read_letter(
    .,.,.,.,1,
    .,.,.,.,.,
    .,1,1,1,1, ##
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,.,1, ##
    1,.,.,.,1,
    .,1,1,1,.),
  "k" = read_letter(
    1,.,.,.,.,
    1,.,.,.,.,
    1,.,.,1,., ##
    1,.,.,1,.,
    1,1,1,.,.,
    1,.,.,1,.,
    1,.,.,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "l" = read_letter(
    1,1,1,.,.,
    .,.,1,.,.,
    .,.,1,.,., ##
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    1,1,1,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "m" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,.,1,.,1, ##
    1,1,1,1,1,
    1,.,1,.,1,
    1,.,1,.,1,
    1,.,1,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.),
  "n" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,.,1,1,., ##
    1,1,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.),
  "o" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,., ##
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    .,1,1,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "p" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,.,1,1,., ##
    1,1,.,.,1,
    1,.,.,.,1,
    1,.,.,.,1,
    1,1,1,1,., ##
    1,.,.,.,.,
    1,.,.,.,.),
  "q" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,1, ##
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,1,1,
    .,1,1,.,1, ##
    .,.,.,.,1,
    .,.,.,.,1),  
  "r" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,1,.,1,1, ##
    .,1,1,.,.,
    .,1,.,.,.,
    .,1,.,.,.,
    1,1,1,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "s" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,1, ##
    1,.,.,.,.,
    .,1,1,1,.,
    .,.,.,.,1,
    1,1,1,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "t" = read_letter(
    .,.,.,.,.,
    .,.,1,.,.,
    1,1,1,1,1, ##
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,.,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),
  "u" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,.,.,.,1, ##
    1,.,.,.,1,
    1,.,.,.,1,
    1,.,.,1,1,
    .,1,1,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.),
  "v" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,.,.,.,1, ##
    1,.,.,.,1,
    .,1,.,1,.,
    .,1,.,1,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "w" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,.,.,.,1, ##
    1,.,1,.,1,
    1,.,1,.,1,
    .,1,.,1,.,
    .,1,.,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "x" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,.,.,.,1, ##
    1,.,.,.,1,
    .,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "y" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,.,.,.,1, ##
    1,.,.,.,1,
    .,1,.,1,.,
    .,1,.,1,.,
    .,.,1,.,., ##
    .,.,1,.,.,
    1,1,.,.,.),  
  "z" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,1,1,1,1, ##
    .,.,.,1,.,
    .,.,1,.,.,
    .,1,.,.,.,
    1,1,1,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),
  "1" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,1,1,.,., ##
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    1,1,1,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "2" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,., ##
    1,.,.,.,1,
    .,.,1,1,.,
    .,1,.,.,.,
    1,1,1,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "3" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,., ##
    1,.,.,.,1,
    .,.,.,.,1,
    .,1,1,1,.,
    .,.,.,.,1, ##
    1,.,.,.,1,
    .,1,1,1,.),
  "4" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,1,., ##
    .,.,1,1,.,
    .,1,.,1,.,
    1,.,.,1,.,
    1,1,1,1,1, ##
    .,.,.,1,.,
    .,.,.,1,.),
  "5" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,1,1,1,1, ##
    1,.,.,.,.,
    1,.,.,.,.,
    1,1,1,1,.,
    .,.,.,.,1, ##
    .,.,.,.,1,
    1,1,1,1,.), 
  "6" = read_letter(
    .,.,1,1,.,
    .,1,.,.,.,
    1,.,.,.,., ##
    1,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1,
    .,1,1,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "7" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    1,1,1,1,1, ##
    .,.,.,.,1,
    .,.,.,1,.,
    .,.,1,.,.,
    .,1,.,.,., ##
    .,1,.,.,.,
    .,1,.,.,.),
  "8" = read_letter(
    .,1,1,1,.,
    1,.,.,.,1, 
    1,.,.,.,1, ##
    .,1,1,1,.,
    1,.,.,.,1,
    1,.,.,.,1, 
    .,1,1,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "9" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,., ##
    1,.,.,.,1,
    1,.,.,.,1,
    .,1,1,1,1,
    .,.,.,.,1, ##
    .,.,.,1,.,
    .,1,1,.,.),
  "0" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,1,1,., ##
    1,.,.,1,1,
    1,.,1,.,1,
    1,1,.,.,1,
    .,1,1,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "\\" = read_letter(
    .,1,.,.,.,
    .,1,.,.,.,
    .,.,1,.,., ##
    .,.,.,1,.,
    .,.,.,1,.,
    .,.,.,.,1,
    .,.,.,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.), 
  "]" = read_letter(
    .,.,.,1,1,
    .,.,.,.,1,
    .,.,.,.,1, ##
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),
  "^" = read_letter(
    .,.,1,.,.,
    .,1,.,1,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "_" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.,
    1,1,1,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "`" = read_letter(
    1,.,.,.,.,
    .,1,.,.,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.), 
  "!" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,1, ##
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,.,., ##
    .,.,.,.,1,
    .,.,.,.,1), 
  '"' = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,.,1,., ##
    .,1,.,1,.,
    .,1,.,1,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "#" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,1,.,1,., ##
    .,1,.,1,.,
    1,1,1,1,1,
    .,1,.,1,.,
    1,1,1,1,1, ##
    .,1,.,1,.,
    .,1,.,1,.),  
  "$" = read_letter(
    .,.,.,.,.,
    .,.,1,.,.,
    .,1,1,1,1, ##
    1,.,1,.,.,
    .,1,1,1,.,
    .,.,1,.,1,
    1,1,1,1,., ##
    .,.,1,.,.,
    .,.,.,.,.),  
  "%" = read_letter(
    .,1,1,.,1,
    .,1,1,.,1,
    .,.,.,1,., ##
    .,.,1,.,.,
    .,.,1,.,.,
    .,1,.,1,1,
    .,1,.,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),
  "&" = read_letter(
    .,1,1,.,.,
    1,.,.,.,.,
    1,.,.,.,., ##
    .,1,1,1,1,
    1,.,.,1,.,
    1,.,.,1,.,
    .,1,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "'" = read_letter(
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  ")" = read_letter(
    .,.,.,1,.,
    .,.,.,.,1,
    .,.,.,.,1, ##
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "(" = read_letter(
    .,.,.,.,1,
    .,.,.,1,.,
    .,.,.,1,., ##
    .,.,.,1,.,
    .,.,.,1,.,
    .,.,.,1,.,
    .,.,.,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.),
  "*" = read_letter(
    .,1,.,1,.,
    .,.,1,.,.,
    .,1,.,1,., ##
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "+" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,1,.,., ##
    .,.,1,.,.,
    1,1,1,1,1,
    .,.,1,.,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "," = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,1,.,., ##
    .,.,1,.,.,
    .,1,.,.,.),  
  "." = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,1,.,
    .,.,.,1,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "/" = read_letter(
    .,.,.,.,1,
    .,.,.,.,1,
    .,.,.,1,., ##
    .,.,1,.,.,
    .,.,1,.,.,
    .,1,.,.,.,
    .,1,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  ":" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,1,.,., ##
    .,.,1,.,.,
    .,.,.,.,.,
    .,.,1,.,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  ";" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,1, ##
    .,.,.,.,1,
    .,.,.,.,.,
    .,.,.,.,1,
    .,.,.,.,1, ##
    .,.,.,1,.,
    .,.,.,.,.),
  "<" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,1, ##
    .,.,.,1,.,
    .,.,1,.,.,
    .,.,.,1,.,
    .,.,.,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  ">" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,1,.,., ##
    .,.,.,1,.,
    .,.,.,.,1,
    .,.,.,1,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "=" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    1,1,1,1,1,
    .,.,.,.,.,
    1,1,1,1,1,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "?" = read_letter(
    .,1,1,1,.,
    1,.,.,.,1,
    .,.,.,.,1, ##
    .,.,1,1,.,
    .,.,.,.,.,
    .,.,1,.,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.), 
  "@" = read_letter(
    .,1,1,1,.,
    1,.,.,.,1,
    1,.,1,1,1, ##
    1,1,.,1,1,
    1,1,1,1,1,
    1,.,.,.,.,
    .,1,1,1,1, ##
    .,.,.,.,.,
    .,.,.,.,.),  
  "{" = read_letter(
    .,.,.,.,1,
    .,.,.,1,.,
    .,.,.,1,., ##
    .,.,1,.,.,
    .,.,.,1,.,
    .,.,.,1,.,
    .,.,.,.,1, ##
    .,.,.,.,.,
    .,.,.,.,.), 
  "}" = read_letter(
    .,.,1,.,.,
    .,.,.,1,.,
    .,.,.,1,., ##
    .,.,.,.,1,
    .,.,.,1,.,
    .,.,.,1,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.), 
  "|" = read_letter(
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,., ##
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,.,
    .,.,1,.,., ##
    .,.,.,.,.,
    .,.,.,.,.),
  "-" = read_letter(
    .,.,.,.,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,1,1,1,.,
    .,.,.,.,.,
    .,.,.,.,., ##
    .,.,.,.,.,
    .,.,.,.,.)
)

# coerce to a tibble
char_table <- char_list %>% 
  imap_dfr(function(x,n) {
    x %>% as.tibble() %>%
      mutate(ypos = 9:1) %>%
      gather(key = "xpos", value = "value", V1, V2, V3, V4, V5, V6) %>%
      mutate(xpos = xpos %>% str_remove("V") %>% as.integer()) %>%
      mutate(char = n)
  }) 

# write file
write_csv(char_table, "data/char_map.csv")

# sanity check
plot_char <- function(data, character, value = 1, size = 10) {
  data %>% 
    filter(char == !!character & value == !!value) %>%
    ggplot(aes(x=xpos, y=ypos)) + 
    geom_point(size = size) + 
    coord_equal() + 
    xlim(0, 7) + 
    ylim(0, 10)
}

char_table %>% plot_char("J") %>% plot()


# message to plot
msg <- list(
  frame1 = c("R Memes for Statistical Fiends", "Don't Let your Memes be Dreams"),
  frame2 = c("Don't Let your Memes be Dreams", "R Memes for Statistical Fiends")
)

# convert the message to a tidy form
msg_frame <- msg %>% 
  imap_dfr(
    function(m, v) {  # apply to each frame:
      m %>%
        str_split("") %>% # split into a list (one element per "line")
        imap_dfr(
          function(x, v) { # apply to each line
            x %>% 
              as.tibble() %>% 
              rename(char = value) %>%
              mutate(
                xoff = 6 * (1:n()), # scaled x-offset for each character
                yoff = v            # unscaled y-offset for each character
              )
          }) %>% 
        mutate(
          yoff = 10 * (max(yoff) - yoff),  # scale the y-offset
          frame = v %>% str_remove("frame") %>% as.integer() # append frame info
        )
    })

# left join with the character table to produce 
# co-ordinate map for the raw points in each frame
msg_map <- left_join(msg_frame, char_table) %>%
  filter(value == 1)

msg_map %>% group_by(frame) %>% 
  summarise(count = n()) %>% print()



# read the message map
msg_map <- msg_map %>%
  mutate(xval = xpos + xoff, yval = ypos + yoff) %>%
  arrange(frame, xval, yval) 

# dot count
dot_count <-  msg_map %>% group_by(frame) %>% 
  summarise(count = n())

# give each dot a unique identity
msg_map$id <- dot_count$count %>%
  map(function(x){1:x}) %>% reduce(c)


# create the base plot
base_pic <- msg_map %>% 
  ggplot(aes(
    x = xval, 
    y = yval)) + 
  geom_point(
    aes(colour = factor(id)), 
    show.legend = FALSE) + 
  coord_equal() +
  theme_void() +
  scale_color_viridis(begin = .1, end = .9, discrete = T)


anim <- TRUE
if(!anim) {
  
  # draw as a faceted plot
  pic <- base_pic + 
    facet_grid(frame ~ .)
  plot(pic)
  
} else {
  
  # construct animation
  pic <- base_pic  +
    transition_states(
      states = frame,
      transition_length = 2,
      state_length = 1,
      wrap = TRUE
    )  +
    ease_aes('linear') +
    shadow_wake(.1)
  
  # create animation
  pic %>% animate(
    nframes = 50, fps = 20, width = 800, height = 150)
  anim_save("images/full_animation.gif")
}